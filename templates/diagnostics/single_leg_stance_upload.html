{% extends 'base.html' %}
{% load static %}

{% block title %}Egy l√°bon √°ll√°s elemz√©s ‚Äì Vide√≥ felt√∂lt√©se{% endblock %}

{% block content %}
<div class="container mx-auto py-6">
    <h2 class="text-2xl font-semibold mb-4">üßò Egy L√°bon √Åll√°s (SLS) √ârt√©kel√©s ‚Äì Vide√≥k felt√∂lt√©se</h2>
    <p class="text-muted mb-4">K√©rj√ºk, t√∂lts√∂n fel egy vide√≥t **mindk√©t l√°bra k√ºl√∂n-k√ºl√∂n** (kb. 20-30 mp/oldal). A kamera legyen **szemb≈ël**, a teljes test √©s a l√°bfejek l√°that√≥ak legyenek, ahogy a dokument√°ci√≥ is javasolja.</p>

    <form 
        id="upload-form" 
        method="post" 
        novalidate
        data-sign-url="{% url 'diagnostics:get_signed_gcs_url' %}"
        {# ‚ö†Ô∏è JAV√çT√ÅS: A job_list hiba jav√≠t√°sa. Az 'athlete_dashboard' n√©vre ir√°ny√≠tunk √°t. #}
        data-redirect-url="{% url 'diagnostics:athlete_diagnostics' %}"
    >
        {% csrf_token %}
        
        <div class="mb-3">
            <label for="id_video_left" class="form-label">Bal l√°b ‚Äì Vide√≥ felt√∂lt√©se</label>
            {# Fontos, hogy a name attributum 'video_left' legyen, ahogy a view.py v√°rja #}
            <input type="file" name="video_left" id="id_video_left" accept="video/mp4" class="form-control" required>
            <div class="form-text">MP4 form√°tum, a bal l√°bon √°ll√°s l√°tsz√≥djon szemb≈ël.</div>
        </div>

        <div class="mb-3">
            <label for="id_video_right" class="form-label">Jobb l√°b ‚Äì Vide√≥ felt√∂lt√©se</label>
            {# Fontos, hogy a name attributum 'video_right' legyen, ahogy a view.py v√°rja #}
            <input type="file" name="video_right" id="id_video_right" accept="video/mp4" class="form-control" required>
            <div class="form-text">MP4 form√°tum, a jobb l√°bon √°ll√°s l√°tsz√≥djon szemb≈ël.</div>
        </div>
        
        <div class="mb-3">
            {{ form.notes.label_tag }}
            {{ form.notes }}
            <div class="form-text">{{ form.notes.help_text }}</div>
        </div>
        
        <div id="progress-container" class="mt-4" style="display:none;">
            <div class="progress" role="progressbar" aria-label="Felt√∂lt√©s" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" style="width: 0%"></div>
            </div>
            <p id="status-message" class="mt-2 text-info small">Vide√≥k felt√∂lt√©se folyamatban...</p>
        </div>

        <button type="submit" id="submit-button" class="btn btn-primary mt-3">Elemz√©s ind√≠t√°sa</button>
    </form>
</div>
{% endblock %}

{% block extra_js %}
{# A Vertical Jump-hoz hasonl√≥an haszn√°ljuk a k√∂z√∂s felt√∂lt≈ë scriptet #}
{% include "diagnostics/partials/gcs_upload_script.html" %} 
{% endblock %}